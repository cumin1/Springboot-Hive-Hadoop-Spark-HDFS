<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>梯度计算与应用</title>
		<link rel="stylesheet" type="text/css" href="../style/bootstrap.css"/>
		<link rel="stylesheet" type="text/css" href="css/link1.css"/>
		<script id="MathJax-script" async src="../js/es5/tex-chtml.js"></script>
		<script>
		MathJax = {
		  tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
		};
		</script>
	</head>
	<body class="container-fluid">		
		<h2 class="my-5 hnav">梯度计算与应用</h2>
		<div id="right_nav">
			<ul>
				<li class="active">知识</li>
				<li>实训</li>
				<li>拓展</li>
				<li class='last'>顶部</li>
			</ul>
		</div>
		<h3 class="mb-3 son_wrap" id='knowledge'>一、知识</h3>
		<p>回忆一下，对函数$z=f(x,y)$ ，如何求最小值点$(x,y)$ 呢？对于光滑函数$z=f(x,y)$ ，$\frac{\partial f(x,y)}{\partial x}$，$\frac{\partial f(x,y)}{\partial y}$取得最小值的$(x,y)$必要条件：$$\frac{\partial f(x,y)}{\partial x}=0,\frac{\partial f(x,y)}{\partial y}=0$$</p>
		<p>然而，在实际问题中，上述方程通常不容易求解，那么该如何解决呢？梯度下降法是一种很好替代方法。该方法不直接求解上述方程，而是通过逐渐移动图像上的点进行试探，最终找出函数的最小值。</p>
		<ol>
			<li>
				<h5>梯度下降法<span class="ktitle ml-5 badge badge-light badge-pill">show more</span></h5>
				<div class="kdetails">
					<p class="mt-3">梯度下降法含义是什么呢？这里我们将图像想像成一个滑雪赛道（如图1），运动员在点S处选择下降速度最快方向到P点，然后从P点选择最快方向滑向Q点，再到E点，依次类推。这个操作反复进行若干次后，运动员沿着最短的路径到达底部目的地，也就是函数的最小值点。梯度下降法就模拟了运动员的移动过程。</p>
					<div class="row mb-3">
						<div class="col text-center">
							<img src="img/2-1-1.PNG" >
							<div>图1&nbsp;&nbsp;&nbsp;&nbsp;梯度下降法示意图</div>
						</div>						
					</div>						
					<p>在数值分析领域，梯度下降法也称为最速下降法。</p>
				</div>				
			</li>
			<li>
				<h5>梯度下降法数学形式化<span class="ktitle ml-5 badge badge-light badge-pill">show more</span></h5>
				<div class="kdetails">
					<p class="my-3">下面让我们依照前面考察过的思路来将梯度下降法数学形式化。</p>
					<p> $\Delta z= \frac{\partial z}{\partial x} \Delta x+\frac{\partial z}{\partial y} \Delta y$可以表示为如下两个向量的内积形式。$$(\frac{\partial z}{\partial x},\frac{\partial z}{\partial y})\cdot(\Delta x ,\Delta y)^T$$</p>
					<p>上式两个向量的内积关系就是梯度下降法的出发点。</p>
					<div class="text-center container-fluid"><img src="img/2-1-2.png" class="img-fluid">
					</div>
					<p>
 
向量 与 的内积大小与夹角 的关系如图2所示。
</p>
					<!-- <img src="img/vector3.png" class="text-center"> -->
					<p class="mt-3">假设我们只考虑两个特征：bmi、chcharges。每一个男士A特征为（27.9,16884.924），第二位女士B特征为（33,4449.462），第三位女士C特征为（28.88,3866.85520）。</p>
				</div>				
			</li>
			<li>
				<h5>向量计算<span class="ktitle ml-5 badge badge-light badge-pill">show more</span></h5>
				<div class="kdetails">
					<ul class="vector-cal">
						<li>向量模：$|x|=\sqrt{x_1^2+x_2^2+\cdots+x_n^2}$</li>
						<li>向量数乘：$\lambda{x}=(\lambda{x_1},\lambda{x_2},\cdots,\lambda{x_n})^T$</li>
						<li>向量和、差：$x\pm y=(x_1\pm y_1,x_2\pm y_2,\cdots,x_n\pm y_n)^T$
							<div class="row mb-3">
								<div class="col text-center">
									<!-- <img src="img/vector7.png" height="101"> -->
									<div>图3&nbsp;&nbsp;&nbsp;&nbsp;向量数乘	</div>
								</div>
								<div class="col text-center">
									<!-- <img src="img/vector8.png" > -->
									<div>图4&nbsp;&nbsp;&nbsp;&nbsp;向量和、差	</div>
								</div>
								<div class="col text-center">
									<!-- <img src="img/vector9.png" height="101" > -->
									<div>图5&nbsp;&nbsp;&nbsp;&nbsp;向量夹角θ</div>
								</div>
							</div>
						</li>
						<li>向量内积：两个$n$维向量$x=(x_1,x_2,\cdots,x_n)^T$和$y=(y_1,y_2,\cdots,y_n)^T$的内积为：$$x\cdot y=x_1 y_1 + x_2 y_2 +\cdots+x_n y_n=\sum_{i=1}^n {x_i y_i} ，x \cdot y=|x||y| \cos \theta。$$
						<p>两个向量的“积”，相当于两个“方向与方向的乘积”。向量的3种关系：</p>
						<div class="row mb-3">
							<div class="col text-center">
								<!-- <img src="img/vector12.png"> -->
								<div class="row align-items-center justify-content-center">
									<div class="col-2">(a)</div>
									<div class="col-5">
										<p class="img-cap">$\theta=180°$<br/>$(\cos \theta=-1)$</p>
									</div>
								</div>
							</div>
							<div class="col text-center">
								<!-- <img src="img/vector13.png" height="88"> -->
								<div class="row align-items-center justify-content-center">
									<div class="col-2">(b)</div>
									<div class="col-6">
										<!-- <p class="img-cap">0&lt;θ&lt;180°<br/>(-1&lt;cosθ&lt;-1)</p> -->
										<p class="img-cap">$0<\theta<180°$<br/>$(-1<\cos\theta<1)$</p>
									</div>
								</div>
							</div>
							<div class="col text-center">
								<!-- <img src="img/vector14.png" height="88"> -->
								<div class="row align-items-center justify-content-center">
									<div class="col-2">(c)</div>
									<div class="col-6">
										<p class="img-cap">$\theta=0°$<br/>$(\cos\theta=1)$</p>
									</div>
								</div>
							</div>
						</div>
						<div class="text-center">图6&nbsp;&nbsp;&nbsp;&nbsp;两个向量方向的3种关系</div>
						</li>
					</ul>
					<p class="mt-3">我们根据两个向量的夹角来判断向量之间的相似度。夹角θ越小，cosθ值越大，相似度越高。</p>
					<div class="row mb-3">
						<div class="col text-center">
							<!-- <img src="img/vector12.png" > -->
							<div>(a)非常不相似</div>
						</div>
						<div class="col text-center">
							<!-- <img src="img/vector13.png" height="88"> -->
							<div>(b)有点不相似</div>
						</div>
						<div class="col text-center">
							<!-- <img src="img/vector14.png" height="88" > -->
							<div>(c) 有点相似</div>
						</div>
						<div class="col text-center">
							<!-- <img src="img/vector15.png" height="88" > -->
							<div>(d)非常相似</div>
						</div>
					</div>
					<div class="text-center">图7&nbsp;&nbsp;&nbsp;&nbsp;两个向量的相对相似度</div>
				</div>				
			</li>
		</ol>
		<h3 class="mb-3 son_wrap" id="training">二、实训</h3>
		<h6><b class="task">任务：</b>判断例1中 男士A、女士B和女士C之间的相似度</h6>
		<p>A=（27.9,16884.924），B=（33.77,1725.5523），C=（33,4449.462）</p>
		<p><kbd>Step1</kbd>&nbsp;&nbsp;导入库</p>
		<p class="p-code">
			<code>#导入numpy库<br/>import numpy as np</code>&nbsp;&nbsp;&nbsp;&nbsp;
			<button type="button" class="btn btn-sm btn-primary copyBtn">复制</button>
		</p>
		<p><kbd>Step2</kbd>&nbsp;&nbsp;构建向量</p>
		<p class="p-code">
			<code>#构建行向量，注意：两个中括号<br/>A=np.array([[27.9,16884.924]])<br/>B=np.array([[33,4449.462]])<br/>C=np.array([[28.88,3866.85520]])</code>&nbsp;&nbsp;&nbsp;&nbsp;<button type="button" class="btn btn-sm btn-primary copyBtn">复制</button>
		</p>
		<p><kbd>Step3</kbd>&nbsp;&nbsp;计算A、B、C之间的夹角余弦值</p>
		<p class="p-code">
			<code>#计算AB内积，其中B.T为B的转置，把行向量转置成列向量<br/>inner_AB=A.dot(B.T)<br/>#A.dot(B.T为向量A、B的内积函数<br/>inner_AC=A.dot(C.T)<br/>#np.linalg.norm()为向量求模函数<br/>inner_BC=B.dot(C.T)<br/>print("A、B夹角余弦：",inner_AB/(np.linalg.norm(A)*np.linalg.norm(B)))<br/>print("A、C夹角余弦：",inner_AC/(np.linalg.norm(A)*np.linalg.norm(C)))<br/>print("B、C夹角余弦：",inner_BC/(np.linalg.norm(B)*np.linalg.norm(C)))</code>&nbsp;&nbsp;&nbsp;&nbsp;
			<button type="button" class="btn btn-sm btn-primary copyBtn">复制</button>			
		</p>
		<p><kbd>Step4</kbd>&nbsp;&nbsp;结论</p>
		<p class="p-code">A、B夹角余弦：0.99998309<br/>A、C夹角余弦：0.99998339<br/>B、C夹角余弦：1<br/>由同学们选择，系统给予评判。
</p>
		<h3 id="extend" class="son_wrap">三、拓展</h3>
		<p><b class="task">任务：</b>鸢（yuān）尾花数据集iris有50个样本数据构成。每个样本有4个特征（属性）：Sepal.Length（花萼长度）、Sepal.Width（花萼宽度）、Petal.Length（花瓣长度）、Petal.Width（花瓣宽度），单位是cm。</p>
		<p>选择一个样本Iris Setosa（山鸢尾）和一个样本Iris Versicolour（杂色鸢尾）。</p>
		<p>Iris Setosa（山鸢尾）特征：（5.1, 3.5, 1.4, 0.2）</p>
		<p>Iris Versicolour（杂色鸢尾）特征：(7, 3.2, 4.7, 1.4)</p>
		<p>若有一个新样本，其特征为：(4.9, 3, 1.4, 0.2)，判断其最有可能属于Iris Setosa（山鸢尾）或Iris Versicolour（杂色鸢尾）中哪一种？&nbsp;&nbsp;&nbsp;&nbsp;<button class="btn btn-sm btn-success" id='tips'>点击查看答案</button></p>
		<div class="answer">
			<p><kbd>Step1</kbd>&nbsp;&nbsp;导入库</p>
					<p class="p-code">
						<code>import numpy as np&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#导入numpy库</code>
					</p>
					<p><kbd>Step2</kbd>&nbsp;&nbsp;构建向量</p>
					<p class="p-code">
						<code>A=np.array([[5.1, 3.5, 1.4, 0.2]])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Iris Setosa（山鸢尾）<br/>
			B=np.array([[7, 3.2, 4.7, 1.4]])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Iris Versicolour（杂色鸢尾）<br/> 
			C=np.array([[4.9, 3, 1.4, 0.2]])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#未知类型
			</code>
					</p>
					<p><kbd>Step3</kbd>&nbsp;&nbsp;计算A、B、C之间的夹角余弦值</p>
					<p class="p-code">
						<code>inner_AC=A.dot(C.T)&nbsp;&nbsp;&nbsp;&nbsp;#计算AC内积<br/>
			inner_BC=B.dot(C.T)&nbsp;&nbsp;&nbsp;&nbsp;#计算BC内积<br/>
			#np.linalg.norm()为向量求模函数<br/>
			print("A、C夹角余弦：",inner_AC/(np.linalg.norm(A)*np.linalg.norm(C)))<br/>
			print("B、C夹角余弦：",inner_BC/(np.linalg.norm(B)*np.linalg.norm(C)))
</code>
					</p>
					<p><kbd>Step4</kbd>&nbsp;&nbsp;结论</p>
					<p class="p-code">A、C夹角余弦：0.99857916<br/>B、C夹角余弦：0.94000276	</p>
			<p>由此可知，C与A相似度更高，C更可能属于Iris Setosa（山鸢尾）。事实也如此。</p>		
		</div>
		<div class="program" draggable="true">
			<div class="pro-text card bg-light">
				<form>
					<h3 class="card-title">程序调试<button type="button" class="close"><span>&times;</span></button></h3>
					<textarea id='pro'></textarea><br/>
					<div class="card-footer">
						<input type="submit" value="运行程序" class="btn btn-info"/>
						<input type="reset" name="" id="pro-clear" value="清空" class="btn btn-warning"/>
					</div>					
				</form>
			</div>
			<div id='pro-result'>
				此处显示运行结果
			</div>
		</div>
		<script src="../js/jquery-3.4.1.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/bootstrap.bundle.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/link.js" type="text/javascript" charset="utf-8"></script>
	</body>
</html>
